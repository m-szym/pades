<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SCC-PAdES: service.key_loading.LocalKeyLoader Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SCC-PAdES<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Toolset for emulating PAdES digital signature standard</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceservice.html">service</a></li><li class="navelem"><a class="el" href="namespaceservice_1_1key__loading.html">key_loading</a></li><li class="navelem"><a class="el" href="classservice_1_1key__loading_1_1LocalKeyLoader.html">LocalKeyLoader</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classservice_1_1key__loading_1_1LocalKeyLoader-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">service.key_loading.LocalKeyLoader Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of KeyLoader interface for loading keys from PEM files.  
 <a href="classservice_1_1key__loading_1_1LocalKeyLoader.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for service.key_loading.LocalKeyLoader:</div>
<div class="dyncontent">
<div class="center"><img src="classservice_1_1key__loading_1_1LocalKeyLoader__inherit__graph.png" border="0" usemap="#aservice_8key__loading_8LocalKeyLoader_inherit__map" alt="Inheritance graph"/></div>
<map name="aservice_8key__loading_8LocalKeyLoader_inherit__map" id="aservice_8key__loading_8LocalKeyLoader_inherit__map">
<area shape="rect" title="Implementation of KeyLoader interface for loading keys from PEM files." alt="" coords="22,79,211,119"/>
<area shape="rect" href="interfaceservice_1_1key__loading_1_1KeyLoader.html" title="Interface for loading cryptographic keys from files." alt="" coords="5,5,228,31"/>
<area shape="poly" title=" " alt="" coords="119,44,119,79,114,79,114,44"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for service.key_loading.LocalKeyLoader:</div>
<div class="dyncontent">
<div class="center"><img src="classservice_1_1key__loading_1_1LocalKeyLoader__coll__graph.png" border="0" usemap="#aservice_8key__loading_8LocalKeyLoader_coll__map" alt="Collaboration graph"/></div>
<map name="aservice_8key__loading_8LocalKeyLoader_coll__map" id="aservice_8key__loading_8LocalKeyLoader_coll__map">
<area shape="rect" title="Implementation of KeyLoader interface for loading keys from PEM files." alt="" coords="22,79,211,119"/>
<area shape="rect" href="interfaceservice_1_1key__loading_1_1KeyLoader.html" title="Interface for loading cryptographic keys from files." alt="" coords="5,5,228,31"/>
<area shape="poly" title=" " alt="" coords="119,44,119,79,114,79,114,44"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9507a66b785c11a0694f797796069f8c" id="r_a9507a66b785c11a0694f797796069f8c"><td class="memItemLeft" align="right" valign="top">PrivateKey&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classservice_1_1key__loading_1_1LocalKeyLoader.html#a9507a66b785c11a0694f797796069f8c">loadPrivateKey</a> (File file, String pin)  throws InvalidKeyFileException </td></tr>
<tr class="memdesc:a9507a66b785c11a0694f797796069f8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads a private key from the specified file using the provided PIN.  <br /></td></tr>
<tr class="separator:a9507a66b785c11a0694f797796069f8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24285076960c30178c83b6f59ade717f" id="r_a24285076960c30178c83b6f59ade717f"><td class="memItemLeft" align="right" valign="top">PublicKey&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classservice_1_1key__loading_1_1LocalKeyLoader.html#a24285076960c30178c83b6f59ade717f">loadPublicKey</a> (File file)  throws InvalidKeyFileException </td></tr>
<tr class="memdesc:a24285076960c30178c83b6f59ade717f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads a public key from the specified file.  <br /></td></tr>
<tr class="separator:a24285076960c30178c83b6f59ade717f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a0f552ae43055ad9ae2011480ba9f553c" id="r_a0f552ae43055ad9ae2011480ba9f553c"><td class="memItemLeft" align="right" valign="top">static SecretKey&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classservice_1_1key__loading_1_1LocalKeyLoader.html#a0f552ae43055ad9ae2011480ba9f553c">deriveKeyFromPin</a> (String pin)  throws Exception </td></tr>
<tr class="memdesc:a0f552ae43055ad9ae2011480ba9f553c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a symmetric AES key from a user-provided PIN.  <br /></td></tr>
<tr class="separator:a0f552ae43055ad9ae2011480ba9f553c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bf27a6b684c587a382a7d4cc3c0bbb3" id="r_a0bf27a6b684c587a382a7d4cc3c0bbb3"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classservice_1_1key__loading_1_1LocalKeyLoader.html#a0bf27a6b684c587a382a7d4cc3c0bbb3">decryptPrivateKey</a> (String encryptedPrivateKey, String pin)  throws Exception </td></tr>
<tr class="memdesc:a0bf27a6b684c587a382a7d4cc3c0bbb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts an encrypted private key using a PIN-derived AES key.  <br /></td></tr>
<tr class="separator:a0bf27a6b684c587a382a7d4cc3c0bbb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of KeyLoader interface for loading keys from PEM files. </p>
<p>This class is meant to be used for development purposes only and should not be used in production. It assumes that the keys are stored in PEM format and are not password-protected, as such the PIN for the private key file is never used. The class provides methods to load private and public keys from specified local PEM files. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a0bf27a6b684c587a382a7d4cc3c0bbb3" name="a0bf27a6b684c587a382a7d4cc3c0bbb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bf27a6b684c587a382a7d4cc3c0bbb3">&#9670;&#160;</a></span>decryptPrivateKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static String service.key_loading.LocalKeyLoader.decryptPrivateKey </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>encryptedPrivateKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>pin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> throws Exception</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Decrypts an encrypted private key using a PIN-derived AES key. </p>
<p>Converts the encrypted private key from Base64, decrypts it using AES, and returns the original private key as a string.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encryptedPrivateKey</td><td>The Base64-encoded encrypted private key. </td></tr>
    <tr><td class="paramname">pin</td><td>The PIN used to derive the AES key for decryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The decrypted private key as a plain text string. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Exception</td><td>If decryption fails or the cipher cannot be initialized. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0f552ae43055ad9ae2011480ba9f553c" name="a0f552ae43055ad9ae2011480ba9f553c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f552ae43055ad9ae2011480ba9f553c">&#9670;&#160;</a></span>deriveKeyFromPin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static SecretKey service.key_loading.LocalKeyLoader.deriveKeyFromPin </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>pin</em></td><td>)</td>
          <td> throws Exception</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Derives a symmetric AES key from a user-provided PIN. </p>
<p>Uses SHA-256 to hash the PIN and create a 256-bit AES key. This key can then be used for encrypting or decrypting sensitive data, such as a private key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pin</td><td>The PIN entered by the user. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SecretKey derived from the provided PIN. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Exception</td><td>If the SHA-256 algorithm is not available. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9507a66b785c11a0694f797796069f8c" name="a9507a66b785c11a0694f797796069f8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9507a66b785c11a0694f797796069f8c">&#9670;&#160;</a></span>loadPrivateKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PrivateKey service.key_loading.LocalKeyLoader.loadPrivateKey </td>
          <td>(</td>
          <td class="paramtype">File&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>pin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> throws InvalidKeyFileException</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads a private key from the specified file using the provided PIN. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The file from which the private key is to be loaded. </td></tr>
    <tr><td class="paramname">pin</td><td>The PIN used to access the private key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The loaded PrivateKey. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidKeyFileException</td><td>If an error occurs while loading the private key. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="interfaceservice_1_1key__loading_1_1KeyLoader.html#a9a5d4ad81ebd9fcd0e03649a4c46e1e4">service.key_loading.KeyLoader</a>.</p>

</div>
</div>
<a id="a24285076960c30178c83b6f59ade717f" name="a24285076960c30178c83b6f59ade717f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24285076960c30178c83b6f59ade717f">&#9670;&#160;</a></span>loadPublicKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PublicKey service.key_loading.LocalKeyLoader.loadPublicKey </td>
          <td>(</td>
          <td class="paramtype">File&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td> throws InvalidKeyFileException</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads a public key from the specified file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The file from which the public key is to be loaded. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The loaded PublicKey. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidKeyFileException</td><td>If an error occurs while loading the public key. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="interfaceservice_1_1key__loading_1_1KeyLoader.html#a70371b09b121f489c95885eba699ef0a">service.key_loading.KeyLoader</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>main-app/src/main/java/service/key_loading/<a class="el" href="LocalKeyLoader_8java.html">LocalKeyLoader.java</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
